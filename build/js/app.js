(function(){window.app=angular.module("twtrApp",["ngRoute","ngResource","templatescache","LocalStorageModule"]),window.app.config(["$routeProvider","$locationProvider","localStorageServiceProvider",function(e,t,r){return e.when("/tweet/:id",{templateUrl:"../pages/tweet.html",controller:"TweetPageController"}).when("/signin",{templateUrl:"../pages/signin.html",controller:"SigninPageController"}).otherwise({redirectTo:"/",templateUrl:"../pages/index.html",controller:"IndexPageController"}),t.html5Mode(),r.setPrefix("twtrApp")}]),window.app.run(["$rootScope","$location","authService",function(e,t,r){return e.$on("$routeChangeStart",function(e){return console.log("user isLogged",r.isLogged()),r.isLogged()?void 0:t.path("/signin")})}])}).call(this),function(){window.app.controller("IndexPageController",["$rootScope","$scope","TweetEntity","tweetsRepository","authService","backendService",function(e,t,r,n,o,i){return t.currentUser=o.getCurrentUser(),t.tweets=null,console.log("userId",t.currentUser.ownerId),t.init=function(){return t.readAll()},t.readAll=function(){return n.readAll(t.currentUser.ownerId).then(function(e){return console.log("readAll tweets",e.data),t.tweets=e.data},function(e){return console.log("readAll error",e)})},t.addTweet=function(){var e;return e=new r({text:t.newTweetText.trim()}),n.addTweet(e).then(function(e){return t.readAll(),t.newTweetText=""},function(e){return console.log("addTweet error",e)})},t.removeTweet=function(e){return n.removeTweet(e).then(function(e){return t.readAll()},function(e){return console.log("removeTweet error",e)})},t.init()}])}.call(this),function(){window.app.controller("SigninPageController",["$scope","$location","authService","UserEntity",function(e,t,r,n){return e.userSignIn=function(){return r.login(e.email,e.password).then(function(e){return t.path("/")})}}])}.call(this),function(){window.app.controller("TweetPageController",["$rootScope","$scope","$routeParams","tweetsRepository",function(e,t,r,n){return console.log("$rootScope.currentUser",e.currentUser)}])}.call(this),function(){window.app.controller("UserPanelController",["$rootScope","$scope","authService","$location","backendService",function(e,t,r,n,o){return t.name=r.getCurrentUser().email,t.userSignOut=function(){return r.logout().then(function(){return n.path("/signin")})}}])}.call(this),function(){window.app.directive("space",["$templateCache",function(e){return{restrict:"E",replace:!0,template:e.get("space.html")}}])}.call(this),function(){window.app.directive("tweetView",["$templateCache",function(e){return{restrict:"E",replace:!0,template:e.get("tweet-page.html")}}])}.call(this),function(){window.app.directive("tweet",["$templateCache",function(e){return{restrict:"E",replace:!0,template:e.get("tweet.html")}}])}.call(this),function(){window.app.directive("userPanel",["$templateCache",function(e){return{restrict:"E",replace:!0,scope:"=",template:e.get("user-panel.html")}}])}.call(this),function(){window.app.factory("TweetEntity",[function(){var e;return e=function(){function e(e){null==e&&(e={}),this.text=e.text}return e}()}])}.call(this),function(){window.app.factory("UserEntity",[function(){var e;return e=function(){function e(e){null==e&&(e={}),this.id=e.id||0,this.email=e.email}return e}()}])}.call(this),function(){window.app.factory("tweetsRepository",["backendService",function(e){var t;return new(t=function(){function t(){}return t.prototype.readAll=function(t){return e.readAll(t)},t.prototype.addTweet=function(t){return e.addTweet(t)},t.prototype.removeTweet=function(t){return e.removeTweet(t)},t}())}])}.call(this),function(){app.factory("backendService",["$q","TweetEntity",function(e,t){var r;return new(r=function(){function r(){var r,n,o;r="25D38AE7-3C30-2CBE-FF70-A1C71CAF3F00",n="D8C194D6-66C5-F9AF-FFF4-95F759FB8500",o="v1",this.bl=Backendless,this.defer=e.defer(),this.blAsync=new this.bl.Async(this.defer.resolve,this.defer.reject),this.bl.enablePromises(),this.query=new this.bl.DataQuery,this.tweets=new t,this.bl.initApp(r,n,o)}return r.prototype.login=function(e,t){return this.bl.UserService.login(e,t,!0,this.blAsync),this.defer.promise},r.prototype.logout=function(){return this.bl.UserService.logout(this.blAsync),this.defer.promise},r.prototype.readAll=function(e){return this.query={condition:"ownerId = '"+e+"' "},this.bl.Persistence.of("Tweets").find(this.query,this.blAsync),this.defer.promise},r.prototype.addTweet=function(e){return this.bl.Persistence.of("Tweets").save(e,this.blAsync),this.defer.promise},r.prototype.removeTweet=function(e){return this.bl.Persistence.of("Tweets").remove(e,this.blAsync),this.defer.promise},r}())}])}.call(this),function(){}.call(this),function(){app.factory("authService",["$location","$rootScope","localStorageService","backendService",function(e,t,r,n){var o;return new(o=function(){function e(){}return e.prototype.login=function(e,t){return n.login(e,t).then(function(e){return r.set("userIsLogged",!0),r.set("currentUser",e)},function(e){return console.log("Error",e)})},e.prototype.logout=function(){return n.logout().then(function(){return r.remove("userIsLogged"),r.remove("currentUser")})},e.prototype.getCurrentUser=function(){return r.get("currentUser")},e.prototype.isLogged=function(){return r.get("userIsLogged")},e}())}])}.call(this),function(){app.factory("backendService",["$q","TweetEntity",function(e,t){var r;return new(r=function(){function t(){var e,t,r;e="25D38AE7-3C30-2CBE-FF70-A1C71CAF3F00",t="D8C194D6-66C5-F9AF-FFF4-95F759FB8500",r="v1",this.bl=Backendless,this.bl.initApp(e,t,r)}return t.prototype.login=function(t,r){var n,o;return o=e.defer(),n=new this.bl.Async(o.resolve,o.reject),this.bl.UserService.login(t,r,!0,n),o.promise},t.prototype.logout=function(){var t,r;return r=e.defer(),t=new this.bl.Async(r.resolve,r.reject),this.bl.UserService.logout(t),r.promise},t.prototype.readAll=function(t){var r,n,o;return n=e.defer(),r=new this.bl.Async(n.resolve,n.reject),o={condition:"ownerId = '"+t+"'"},this.bl.Persistence.of("Tweets").find(o,r),n.promise},t.prototype.addTweet=function(t){var r,n;return n=e.defer(),r=new this.bl.Async(n.resolve,n.reject),this.bl.Persistence.of("Tweets").save(t,r),n.promise},t.prototype.removeTweet=function(t){var r,n;return n=e.defer(),r=new this.bl.Async(n.resolve,n.reject),this.bl.Persistence.of("Tweets").remove(t,r),n.promise},t}())}])}.call(this);